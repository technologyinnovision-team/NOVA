{% extends "base.html" %}

{% block title %}{{ 'Edit User' if user else 'Create User' }} - Admin Panel{% endblock %}

{% block page_title %}{{ 'Edit User' if user else 'Create User' }}{% endblock %}

{% block content %}
<div
    class="max-w-2xl bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-800 rounded-lg shadow-sm dark:shadow-none transition-theme">
    <div class="px-6 py-4 border-b border-gray-200 dark:border-gray-800">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white">{{ 'Edit User' if user else 'Create New User' }}
        </h2>
    </div>

    <form method="POST" action="" class="p-6 space-y-6">
        <div>
            <label for="username" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Username</label>
            <input type="text" name="username" id="username" required value="{{ user.username if user else '' }}"
                class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-pink focus:ring-pink sm:text-sm px-4 py-2 border">
        </div>

        <div>
            <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Email Address</label>
            <input type="email" name="email" id="email" required value="{{ user.email if user else '' }}"
                class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-pink focus:ring-pink sm:text-sm px-4 py-2 border">
        </div>

        <div>
            <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Password</label>
            <input type="password" name="password" id="password" {% if not user %}required{% endif %}
                class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-pink focus:ring-pink sm:text-sm px-4 py-2 border">
            {% if user %}
            <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">Leave blank to keep current password</p>
            {% endif %}
        </div>

        <div>
            <label for="role_id" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Role</label>
            <select name="role_id" id="role_id" required
                class="mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm focus:border-pink focus:ring-pink sm:text-sm px-4 py-2 border">
                {% for role in roles %}
                <option value="{{ role.id }}" {% if user and user.role_id==role.id %}selected{% endif %}>
                    {{ role.name }}
                </option>
                {% endfor %}
            </select>
        </div>

        <div class="flex items-center">
            <input type="checkbox" name="is_active" id="is_active" {% if not user or user.is_active %}checked{% endif %}
                class="h-4 w-4 text-pink focus:ring-pink border-gray-300 rounded">
            <label for="is_active" class="ml-2 block text-sm text-gray-900 dark:text-white">
                Active Account
            </label>
        </div>

        <div class="flex justify-end pt-4 border-t border-gray-200 dark:border-gray-800">
            <a href="{{ url_for('users.list_users') }}"
                class="bg-white dark:bg-gray-800 py-2 px-4 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink mr-3">
                Cancel
            </a>
            <button type="submit"
                class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-pink hover:bg-pink-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink">
                {{ 'Update User' if user else 'Create User' }}
            </button>
        </div>
    </form>
</div>
{% endblock %}